\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amsfonts,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{exercise}


\title{TD2 MVFA:\@Linear-Time properties}
\date{}


\def\exercise#1{\Large\textbf{Exercise #1}\normalsize\\}
\def\question#1{\textbf{Question #1:}\quad}

\def\ts{\mathcal{TS}}
\def\tss{\mathcal{TS^*}}
\def\traces{\mathit{Traces}}
\def\seta{\{a\}}
\def\setab{\{a,b\}}

\newtheorem*{lemma}{Lemma}
\newtheorem*{theorem}{Theorem}
\DeclareMathOperator{\Pref}{Pref}
\DeclareMathOperator{\Cl}{Cl}

\begin{document}
\maketitle

\begin{Answer}[number=1]
Let $\ts$ be the transition system.
We have:
$$\traces(\ts)=\seta{(\seta\setab)}^\omega\ +\ \seta\emptyset{(\setab\seta)}^\omega$$
\end{Answer}

\begin{Answer}[number=2]
\Question%
Let $\ts=(S,\mathit{Act},\rightarrow,S_0,\mathit{AP},L)$ be a transition system.

We define another transition system without terminal states, $\tss$. Informally, it corresponds to $\ts$ without terminal states: each terminal state has been redirected to a new state which loops on itself.

$$\tss=(S\uplus\{\Omega\},\mathit{Act}\uplus\{\alpha\},\rightarrow^*,S_0,\mathit{AP},L)$$

In which $\Omega$ is a new state and $\alpha$ a new action.

We then define $\rightarrow^*$:
$$\rightarrow^*\quad=\quad\rightarrow\quad\cup\quad\{v\xrightarrow{\alpha} \Omega~|~\nexists (s\in S, \beta\in\mathit{AP}), v\xrightarrow{\beta}s\}\quad\cup\quad\{\Omega\xrightarrow{\alpha}\Omega\}$$
Which means that every connected states in $\mathcal{TS}$ still is in $\mathcal{TS^*}$, any state with no successor is connected to $\Omega$ and $\Omega$ is connected to itself.\\

\Question%
We introduce a lemma that will be helpful in order to prove the theorem.
\begin{lemma}
  \begin{align*}
    \traces(\tss) &= \{t\in\traces(\ts)~|~t\text{ is infinite}\}\\
    &\cup\{t\emptyset^\omega~|~t\in\traces(\ts)\text{ and $t$ is finite}\}
  \end{align*}
\end{lemma}
\begin{proof}
  By double inclusion. % explain more?
\end{proof}


\paragraph{Trace-equivalence preservation:} Let $\ts_1$ and $\ts_2$ be two transition systems such that $\traces(\ts_1)=\traces(\ts_2)$. Let $t_1\in\traces(\tss_1)$. Let us show that $t_1\in\traces(\tss_2)$.

According to the previous lemma, $t_1$ can either be in $\{t\in\traces(\ts_1)~|~t\text{ is infinite}\}$ or in $\{t\ \emptyset^\omega~|~t\in\traces(\ts_1)\text{ and $t$ is finite}\}$.

If $t_1\in\{t\in\traces(\ts_1)~|~t\text{ is infinite}\}$, then $t_1\in\traces(\ts_1)=\traces(ts_2)$. Thus, $t_1$ is an infinite trace of $\ts_2$ and then by the previous lemma, $t_1\in\traces(\tss_2)$.

If $t_1\in\{t\ \emptyset^\omega~|~t\in\traces(\ts_1)\text{ and $t$ is finite}\}$, then $t_1=t\ \emptyset^\omega$ where $t$ is a finite trace of $\ts_1$ and thus a finite trace of $\ts_2$ as well. Then by the previous lemma, $t\ \emptyset^\omega$ is also a trace of $\tss_2$.

We thus have that every trace of $\tss_1$ is a trace of $\tss_2$, which means $\traces(\tss_1)\subseteq\traces(\tss_2)$. The other inclusion is symmetric. We thus have proved that, whenever $\traces(\ts_1)=\traces(\ts_2)$, $\traces(\tss_1)=\traces(\tss_2)$.\\
\end{Answer}


\begin{Answer}[number=3]
  \Question%
  \Question%
  \Question%
  \Question%
  \Question%
  \Question%
  \Question%
  \Question%
\end{Answer}

\begin{Answer}[number=4]
  Let $P$ and $P'$ be two LT properties. The following theorem is true:
  \begin{theorem}
    $\Pref(P) = \Pref(P')$ if and only if $\Cl(P) = \Cl(P')$
  \end{theorem}
  \begin{proof}
    We prove the two implications.
    \begin{description}
      \item[$\Rightarrow$]
        Suppose $\Pref(P) = \Pref(P')$. We have:
        \begin{align*}
          \Cl(P) &= \{\sigma\in{(2^{\textrm{AP}})}^\omega \mid \Pref(\sigma)\subseteq\Pref(P)\}\\
          &= \{\sigma\in{(2^{\textrm{AP}})}^\omega \mid \Pref(\sigma)\subseteq\Pref(P')\} &&\text{ since }\Pref(P) = \Pref(P')\\
          &= \Cl(P')&&\text{ (definition of closure)}
        \end{align*}
      \item[$\Leftarrow$]
        Suppose $\Cl(P) = \Cl(P')$. We have two cases:
        \begin{description}
          \item[Case 1] One of $\Pref(P)$ or $\Pref(P')$ is empty.\\
          Suppose for example that $\Pref(P) = \emptyset$ Then $\Cl(P) = \emptyset = \Cl(P')$.\\
          Thus $\Pref(P') = \emptyset = \Pref(P)$.
          \item[Case 2] $\Pref(P) \neq \emptyset$
          Let $\sigma\in\Pref(P)$ be a prefix of $P$. \\
          There exists an (infinite) trace $\hat{\sigma} \in P$ such that $\sigma\in\Pref(\hat{\sigma})$.

          Since $\hat{\sigma}\in P\subset\Cl(P)$, we have that $\hat{\sigma}\in\Cl(P')$. \\
          Therefore $\sigma\in\Pref(P')$.\\
          $\Pref(P)\subseteq\Pref(P')$. The other inclusion is true for the same reason.

        \end{description}
    \end{description}
  \end{proof}
\end{Answer}

\begin{Answer}[number=5]
\Question%
\Question%
\Question%
\Question%
\end{Answer}


\end{document}
